<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="798px" preserveAspectRatio="none" style="width:1325px;height:798px;background:#FFFFFF;" version="1.1" viewBox="0 0 1325 798" width="1325px" zoomAndPan="magnify"><title>Plan Document PDF Download (AWS Integration)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="326.6621" x="495.5085" y="29.5332">Plan Document PDF Download (AWS Integration)</text><g><title>Benefit Service (AWS API Gateway + Lambda)</title><rect fill="#FFFFFF" height="91.0547" style="stroke:#181818;stroke-width:1;" width="10" x="474.0142" y="197.9219"/></g><g><title>Benefit Service (AWS API Gateway + Lambda)</title><rect fill="#FFFFFF" height="342.3516" style="stroke:#181818;stroke-width:1;" width="10" x="474.0142" y="363.6797"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1005.063" y="228.2734"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1005.063" y="394.0313"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1005.063" y="584.1406"/></g><g><title>Core Plan Document PDF API</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1207.5313" y="454.7344"/></g><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:1.5;" width="1101.3833" x="10" y="543.4375"/><g><title>AH Client BFF</title><rect fill="#000000" fill-opacity="0.00000" height="594.8125" width="8" x="63.731" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="67" x2="67" y1="121.2188" y2="716.0313"/></g><g><title>Benefit Service (AWS API Gateway + Lambda)</title><rect fill="#000000" fill-opacity="0.00000" height="594.8125" width="8" x="475.0142" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="478.313" x2="478.313" y1="121.2188" y2="716.0313"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#000000" fill-opacity="0.00000" height="594.8125" width="8" x="1006.063" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1009.7427" x2="1009.7427" y1="121.2188" y2="716.0313"/></g><g><title>Core Plan Document PDF API</title><rect fill="#000000" fill-opacity="0.00000" height="594.8125" width="8" x="1208.5313" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1212.3833" x2="1212.3833" y1="121.2188" y2="716.0313"/></g><g class="participant participant-head" data-participant="ClientBFF"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.4619" x="20" y="118.1426">AH Client BFF</text><ellipse cx="67.731" cy="52.1094" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M67.731,60.1094 L67.731,87.1094 M54.731,68.1094 L80.731,68.1094 M67.731,87.1094 L54.731,102.1094 M67.731,87.1094 L80.731,102.1094" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="ClientBFF"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.4619" x="20" y="729.5645">AH Client BFF</text><ellipse cx="67.731" cy="741.1406" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M67.731,749.1406 L67.731,776.1406 M54.731,757.1406 L80.731,757.1406 M67.731,776.1406 L54.731,791.1406 M67.731,776.1406 L80.731,791.1406" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="BenefitService"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="305.4023" x="326.313" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="291.4023" x="333.313" y="110.1426">Benefit Service (AWS API Gateway + Lambda)</text></g><g class="participant participant-tail" data-participant="BenefitService"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="305.4023" x="326.313" y="715.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="291.4023" x="333.313" y="736.5645">Benefit Service (AWS API Gateway + Lambda)</text></g><g class="participant participant-head" data-participant="S3Bucket"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176.6406" x="918.7427" y="118.1426">S3 Bucket (plan-doc search)</text><path d="M992.063,67.6094 C992.063,57.6094 1010.063,57.6094 1010.063,57.6094 C1010.063,57.6094 1028.063,57.6094 1028.063,67.6094 L1028.063,93.6094 C1028.063,103.6094 1010.063,103.6094 1010.063,103.6094 C1010.063,103.6094 992.063,103.6094 992.063,93.6094 L992.063,67.6094" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M992.063,67.6094 C992.063,77.6094 1010.063,77.6094 1010.063,77.6094 C1010.063,77.6094 1028.063,77.6094 1028.063,67.6094" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="S3Bucket"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176.6406" x="918.7427" y="729.5645">S3 Bucket (plan-doc search)</text><path d="M992.063,742.6406 C992.063,732.6406 1010.063,732.6406 1010.063,732.6406 C1010.063,732.6406 1028.063,732.6406 1028.063,742.6406 L1028.063,768.6406 C1028.063,778.6406 1010.063,778.6406 1010.063,778.6406 C1010.063,778.6406 992.063,778.6406 992.063,768.6406 L992.063,742.6406" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M992.063,742.6406 C992.063,752.6406 1010.063,752.6406 1010.063,752.6406 C1010.063,752.6406 1028.063,752.6406 1028.063,742.6406" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="CorePDFAPI"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="202.2959" x="1111.3833" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188.2959" x="1118.3833" y="110.1426">Core Plan Document PDF API</text></g><g class="participant participant-tail" data-participant="CorePDFAPI"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="202.2959" x="1111.3833" y="715.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188.2959" x="1118.3833" y="736.5645">Core Plan Document PDF API</text></g><g><title>Benefit Service (AWS API Gateway + Lambda)</title><rect fill="#FFFFFF" height="91.0547" style="stroke:#181818;stroke-width:1;" width="10" x="474.0142" y="197.9219"/></g><g><title>Benefit Service (AWS API Gateway + Lambda)</title><rect fill="#FFFFFF" height="342.3516" style="stroke:#181818;stroke-width:1;" width="10" x="474.0142" y="363.6797"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1005.063" y="228.2734"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1005.063" y="394.0313"/></g><g><title>S3 Bucket (plan-doc search)</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1005.063" y="584.1406"/></g><g><title>Core Plan Document PDF API</title><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1;" width="10" x="1207.5313" y="454.7344"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1318.6792" x="0" y="152.3945"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1318.6792" y1="152.3945" y2="152.3945"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1318.6792" y1="155.3945" y2="155.3945"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2;" width="276.2153" x="521.2319" y="141.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="258.6035" x="527.2319" y="158.7139">Scenario 1: PDF Download - Cached in S3</text><g class="message" data-participant-1="ClientBFF" data-participant-2="BenefitService"><polygon fill="#181818" points="462.0142,193.9219,472.0142,197.9219,462.0142,201.9219,466.0142,197.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67.731" x2="468.0142" y1="197.9219" y2="197.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.2832" x="74.731" y="193.0654">POST /plan-document/retrieve (communicationContentResourceId)</text></g><g class="message" data-participant-1="BenefitService" data-participant-2="S3Bucket"><polygon fill="#181818" points="993.063,224.2734,1003.063,228.2734,993.063,232.2734,997.063,228.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="484.0142" x2="999.063" y1="228.2734" y2="228.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.0659" x="491.0142" y="223.417">Check for communicationContentResourceId/document.pdf</text></g><g class="message" data-participant-1="S3Bucket" data-participant-2="BenefitService"><polygon fill="#181818" points="495.0142,254.625,485.0142,258.625,495.0142,262.625,491.0142,258.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="489.0142" x2="1009.063" y1="258.625" y2="258.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.9033" x="501.0142" y="253.7686">PDF Exists (document.pdf and metadata.json)</text></g><g class="message" data-participant-1="BenefitService" data-participant-2="ClientBFF"><polygon fill="#181818" points="78.731,284.9766,68.731,288.9766,78.731,292.9766,74.731,288.9766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72.731" x2="478.0142" y1="288.9766" y2="288.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.3696" x="84.731" y="284.1201">Return PDF Document (content-type: application/pdf)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1318.6792" x="0" y="318.1523"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1318.6792" y1="318.1523" y2="318.1523"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1318.6792" y1="321.1523" y2="321.1523"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2;" width="301.4854" x="508.5969" y="306.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="283.8735" x="514.5969" y="324.4717">Scenario 2: PDF Download - Not Cached in S3</text><g class="message" data-participant-1="ClientBFF" data-participant-2="BenefitService"><polygon fill="#181818" points="462.0142,359.6797,472.0142,363.6797,462.0142,367.6797,466.0142,363.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67.731" x2="468.0142" y1="363.6797" y2="363.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.2832" x="74.731" y="358.8232">POST /plan-document/retrieve (communicationContentResourceId)</text></g><g class="message" data-participant-1="BenefitService" data-participant-2="S3Bucket"><polygon fill="#181818" points="993.063,390.0313,1003.063,394.0313,993.063,398.0313,997.063,394.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="484.0142" x2="999.063" y1="394.0313" y2="394.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.0659" x="491.0142" y="389.1748">Check for communicationContentResourceId/document.pdf</text></g><g class="message" data-participant-1="S3Bucket" data-participant-2="BenefitService"><polygon fill="#181818" points="495.0142,420.3828,485.0142,424.3828,495.0142,428.3828,491.0142,424.3828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="489.0142" x2="1009.063" y1="424.3828" y2="424.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.3145" x="501.0142" y="419.5264">PDF Not Found</text></g><g class="message" data-participant-1="BenefitService" data-participant-2="CorePDFAPI"><polygon fill="#181818" points="1195.5313,450.7344,1205.5313,454.7344,1195.5313,458.7344,1199.5313,454.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="484.0142" x2="1201.5313" y1="454.7344" y2="454.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.1084" x="491.0142" y="449.8779">GET /eieheader/v5/communicationcontents/{id} (using communicationContentResourceId)</text></g><g class="message" data-participant-1="CorePDFAPI" data-participant-2="BenefitService"><polygon fill="#181818" points="495.0142,481.0859,485.0142,485.0859,495.0142,489.0859,491.0142,485.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="489.0142" x2="1211.5313" y1="485.0859" y2="485.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.6226" x="501.0142" y="480.2295">Return PDF Document (or empty file/error)</text></g><g class="message" data-participant-1="BenefitService" data-participant-2="BenefitService"><line style="stroke:#181818;stroke-width:1;" x1="484.0142" x2="526.0142" y1="515.4375" y2="515.4375"/><line style="stroke:#181818;stroke-width:1;" x1="526.0142" x2="526.0142" y1="515.4375" y2="528.4375"/><line style="stroke:#181818;stroke-width:1;" x1="485.0142" x2="526.0142" y1="528.4375" y2="528.4375"/><polygon fill="#181818" points="495.0142,524.4375,485.0142,528.4375,495.0142,532.4375,491.0142,528.4375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.2134" x="491.0142" y="510.5811">Check PDF byte size (if 0 bytes, return 500 error)</text></g><path d="M10,543.4375 L70.1709,543.4375 L70.1709,551.7891 L60.1709,561.7891 L10,561.7891 L10,543.4375" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:1.5;" width="1101.3833" x="10" y="543.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="25" y="557.9326">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="135.6738" x="85.1709" y="556.8564">[If valid PDF (not 0 bytes)]</text><g class="message" data-participant-1="BenefitService" data-participant-2="S3Bucket"><polygon fill="#181818" points="993.063,580.1406,1003.063,584.1406,993.063,588.1406,997.063,584.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="484.0142" x2="999.063" y1="584.1406" y2="584.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.0488" x="491.0142" y="579.2842">Store PDF as "document.pdf" and metadata.json for communicationContentResourceId</text></g><g class="message" data-participant-1="S3Bucket" data-participant-2="BenefitService"><polygon fill="#181818" points="495.0142,610.4922,485.0142,614.4922,495.0142,618.4922,491.0142,614.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="489.0142" x2="1009.063" y1="614.4922" y2="614.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.7744" x="501.0142" y="609.6357">PDF Stored Successfully</text></g><g class="message" data-participant-1="BenefitService" data-participant-2="ClientBFF"><polygon fill="#181818" points="78.731,640.8438,68.731,644.8438,78.731,648.8438,74.731,644.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72.731" x2="473.0142" y1="644.8438" y2="644.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.3696" x="84.731" y="639.9873">Return PDF Document (content-type: application/pdf)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="1111.3833" y1="653.8438" y2="653.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="55.0107" x="15" y="665.2627">[If 0 bytes]</text><g class="message" data-participant-1="BenefitService" data-participant-2="ClientBFF"><polygon fill="#181818" points="78.731,687.0313,68.731,691.0313,78.731,695.0313,74.731,691.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72.731" x2="473.0142" y1="691.0313" y2="691.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.7324" x="84.731" y="686.1748">Return HTTP 500 Error (or appropriate error response)</text></g><!--SRC=[xLN1Rjf04BtxAqO-WLfYsYWN9281WGIfQb6CbFEoEmxRsBlMxfgKLlttZjU6O6EbIBtM9u_NC-_DUpEsaov5MALCmPtcHORAmUfkGS6hIZKJq9iynR1K3fyDSrAhVX0mxhI1SF80irIM2TF58WHcwv2Y86V6IIvpHgVX51Kcqa6CPYSvLYKdgoNSCuUlR0yVu0lBDeBrVPNwzVhjG337DimYXF4rJ0l-WWvwEH4U2Ct18ZDyMoN6rzLn4tscJLU3X5znfcEAAGo2yHXYZeePgU7JgAd306QCRr60L0G4ut5mx1O6jotIbFijNaDqeEbX8uFEIDoH05ndMQ4azuhEDAcht2DQNHYEIz4l5POx4gUjHJCiSGyzZs2sHVu22JdpVlNemESg5yaRqb6ymmqCkjeYIUO_f7KMUgTrW2a16JfMkdNrtPPp8l2yUBi1WZZAE897T8LHjUwrLwILRs3WzZaHO7cUrfr5XDj0QOdLiFFpcPrVjVjlQMrfgSL25qfSPDhjoTACu7vEgg34BJA19jhTH0sojNqs-YN5R-WLLgfdk5Yia-ryk-rietDsI3dCShU7HAOOeJ7QD2RcfFnvass4oeqIOBEdN2j_akqoWQ6FxKSm5OMRuH1gA9OwM2QmOwaKFhEdIEaweHy0NU_v7pl_xQ8y-b25foQ7vmjtmPnum7D_owT_7H7FHK1SS8xM9aMQxdrYry1qzVNlcuuf_GIMHxqlHtbOhrVUbNdfYfyAAcvqRcH9stj5vjbSAuk4qro3rhx-0G00]--></g></svg>